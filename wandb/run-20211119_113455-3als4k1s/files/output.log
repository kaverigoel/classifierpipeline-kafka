GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name   | Type   | Params
----------------------------------
0 | _model | ResNet | 11.2 M
----------------------------------
11.2 M    Trainable params
0         Non-trainable params
11.2 M    Total params
44.727    Total estimated model params size (MB)
Validation sanity check: 0it [00:00, ?it/s]
/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/torch/nn/functional.py:1806: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.

  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")






















Epoch 0:  82%|████████████████████████████████████████████████▍          | 1538/1875 [00:47<00:10, 32.31it/s, loss=1.56, v_num=15]

Validating:  10%|███████▊                                                                       | 37/375 [00:00<00:02, 118.95it/s]























Epoch 1:  84%|█████████████████████████████████████████████████▎         | 1566/1875 [00:47<00:09, 32.85it/s, loss=1.54, v_num=15]
























Epoch 2:  87%|███████████████████████████████████████████████████▌       | 1638/1875 [00:48<00:06, 34.10it/s, loss=1.53, v_num=15]
Validating:  36%|████████████████████████████                                                  | 135/375 [00:00<00:01, 161.84it/s]
























Epoch 3:  88%|████████████████████████████████████████████████████       | 1656/1875 [00:48<00:06, 34.06it/s, loss=1.55, v_num=15]
























Epoch 4:  90%|█████████████████████████████████████████████████████▏     | 1692/1875 [00:48<00:05, 34.79it/s, loss=1.52, v_num=15]
Validating:  53%|█████████████████████████████████████████▏                                    | 198/375 [00:01<00:01, 171.79it/s]
























Epoch 5:  87%|███████████████████████████████████████████████████▌       | 1638/1875 [00:48<00:07, 33.76it/s, loss=1.52, v_num=15]
























Epoch 6:  92%|██████████████████████████████████████████████████████▍    | 1729/1875 [00:48<00:04, 35.29it/s, loss=1.51, v_num=15]
Validating:  65%|██████████████████████████████████████████████████▌                           | 243/375 [00:01<00:00, 174.72it/s]
























Epoch 7:  91%|█████████████████████████████████████████████████████▊     | 1710/1875 [00:48<00:04, 35.09it/s, loss=1.54, v_num=15]
Validating:  53%|█████████████████████████████████████████▍                                    | 199/375 [00:01<00:00, 176.07it/s]
























Epoch 8:  89%|████████████████████████████████████████████████████▌      | 1672/1875 [00:48<00:05, 34.45it/s, loss=1.52, v_num=15]
Validating:  47%|████████████████████████████████████▌                                         | 176/375 [00:01<00:01, 172.64it/s]
























Epoch 9:  90%|█████████████████████████████████████████████████████▏     | 1691/1875 [00:48<00:05, 34.64it/s, loss=1.52, v_num=15]
Validating:  48%|█████████████████████████████████████▏                                        | 179/375 [00:01<00:01, 173.13it/s]
























Epoch 10:  88%|███████████████████████████████████████████████████▏      | 1653/1875 [00:48<00:06, 34.13it/s, loss=1.52, v_num=15]
























Epoch 11:  90%|█████████████████████████████████████████████████████▏     | 1691/1875 [00:48<00:05, 34.77it/s, loss=1.5, v_num=15]
Validating:  47%|█████████████████████████████████████                                         | 178/375 [00:01<00:01, 174.16it/s]
























Epoch 12:  91%|████████████████████████████████████████████████████▉     | 1710/1875 [00:48<00:04, 34.96it/s, loss=1.52, v_num=15]
Validating:  56%|███████████████████████████████████████████▉                                  | 211/375 [00:01<00:00, 172.05it/s]
























Epoch 13:  89%|███████████████████████████████████████████████████▋      | 1672/1875 [00:48<00:05, 34.40it/s, loss=1.51, v_num=15]
























Epoch 14:  91%|████████████████████████████████████████████████████▉     | 1710/1875 [00:48<00:04, 35.10it/s, loss=1.51, v_num=15]























Epoch 15:  80%|██████████████████████████████████████████████▍           | 1501/1875 [00:47<00:11, 31.78it/s, loss=1.51, v_num=15]

Validating:  95%|██████████████████████████████████████████████████████████████████████████    | 356/375 [00:02<00:00, 173.27it/s]























Epoch 16:  80%|███████████████████████████████████████████████▏           | 1501/1875 [00:47<00:11, 31.65it/s, loss=1.5, v_num=15]
























Epoch 17:  80%|███████████████████████████████████████████████▏           | 1501/1875 [00:47<00:11, 31.62it/s, loss=1.5, v_num=15]
























Epoch 18:  86%|█████████████████████████████████████████████████▉        | 1615/1875 [00:48<00:07, 33.55it/s, loss=1.52, v_num=15]
























Epoch 19:  88%|████████████████████████████████████████████████████       | 1653/1875 [00:48<00:06, 34.21it/s, loss=1.5, v_num=15]

Validating:  38%|█████████████████████████████▉                                                | 144/375 [00:01<00:01, 168.94it/s]























Epoch 20:  87%|██████████████████████████████████████████████████▌       | 1634/1875 [00:48<00:07, 33.90it/s, loss=1.51, v_num=15]
























Epoch 21:  92%|█████████████████████████████████████████████████████▍    | 1729/1875 [00:48<00:04, 35.34it/s, loss=1.51, v_num=15]
Validating:  62%|████████████████████████████████████████████████▍                             | 233/375 [00:01<00:00, 173.26it/s]
























Epoch 22:  92%|██████████████████████████████████████████████████████▍    | 1729/1875 [00:48<00:04, 35.48it/s, loss=1.5, v_num=15]
























Epoch 23:  94%|██████████████████████████████████████████████████████▋   | 1767/1875 [00:49<00:02, 36.00it/s, loss=1.51, v_num=15]























Epoch 24:  83%|████████████████████████████████████████████████▏         | 1558/1875 [00:47<00:09, 32.70it/s, loss=1.51, v_num=15]

Validating:  15%|███████████▊                                                                   | 56/375 [00:00<00:02, 139.39it/s]























Epoch 25:  81%|███████████████████████████████████████████████           | 1520/1875 [00:47<00:11, 31.88it/s, loss=1.51, v_num=15]
























Epoch 26:  88%|████████████████████████████████████████████████████       | 1653/1875 [00:48<00:06, 34.23it/s, loss=1.5, v_num=15]
























Epoch 27:  91%|████████████████████████████████████████████████████▉     | 1710/1875 [00:48<00:04, 35.27it/s, loss=1.49, v_num=15]

Validating:  56%|███████████████████████████████████████████▉                                  | 211/375 [00:01<00:00, 174.96it/s]























Epoch 28:  86%|██████████████████████████████████████████████████▊        | 1615/1875 [00:48<00:07, 33.48it/s, loss=1.5, v_num=15]
























Epoch 29:  88%|████████████████████████████████████████████████████       | 1653/1875 [00:48<00:06, 34.03it/s, loss=1.5, v_num=15]
























Epoch 30:  85%|██████████████████████████████████████████████████▏        | 1596/1875 [00:47<00:08, 33.26it/s, loss=1.5, v_num=15]
























Epoch 31:  84%|█████████████████████████████████████████████████▌         | 1577/1875 [00:47<00:09, 32.94it/s, loss=1.5, v_num=15]
























Epoch 32:  90%|█████████████████████████████████████████████████████▏     | 1691/1875 [00:48<00:05, 35.07it/s, loss=1.5, v_num=15]
























Epoch 33:  89%|███████████████████████████████████████████████████▋      | 1672/1875 [00:48<00:05, 34.54it/s, loss=1.49, v_num=15]
























Epoch 34:  92%|██████████████████████████████████████████████████████▍    | 1729/1875 [00:48<00:04, 35.66it/s, loss=1.5, v_num=15]
























Epoch 35:  92%|██████████████████████████████████████████████████████▍    | 1729/1875 [00:48<00:04, 35.29it/s, loss=1.5, v_num=15]
























Epoch 36:  93%|███████████████████████████████████████████████████████    | 1748/1875 [00:49<00:03, 35.62it/s, loss=1.5, v_num=15]
Validating:  66%|███████████████████████████████████████████████████▏                          | 246/375 [00:01<00:01, 109.59it/s]
























Epoch 37:  89%|███████████████████████████████████████████████████▋      | 1672/1875 [00:48<00:05, 34.18it/s, loss=1.49, v_num=15]
























Epoch 38:  88%|████████████████████████████████████████████████████       | 1653/1875 [00:48<00:06, 34.22it/s, loss=1.5, v_num=15]
























Epoch 39:  87%|██████████████████████████████████████████████████▌       | 1634/1875 [00:48<00:07, 33.88it/s, loss=1.49, v_num=15]
























Epoch 40:  92%|█████████████████████████████████████████████████████▍    | 1729/1875 [00:48<00:04, 35.36it/s, loss=1.49, v_num=15]























Epoch 41:  80%|██████████████████████████████████████████████▍           | 1501/1875 [00:46<00:11, 31.97it/s, loss=1.49, v_num=15]
























Epoch 42:  85%|██████████████████████████████████████████████████▏        | 1596/1875 [00:47<00:08, 33.52it/s, loss=1.5, v_num=15]
























Epoch 43:  84%|████████████████████████████████████████████████▊         | 1577/1875 [00:47<00:09, 32.99it/s, loss=1.49, v_num=15]
























Epoch 44:  83%|████████████████████████████████████████████████▏         | 1558/1875 [00:47<00:09, 32.65it/s, loss=1.48, v_num=15]
























Epoch 45:  85%|█████████████████████████████████████████████████▎        | 1596/1875 [00:48<00:08, 32.92it/s, loss=1.49, v_num=15]
























Epoch 46:  84%|████████████████████████████████████████████████▊         | 1577/1875 [00:48<00:09, 32.73it/s, loss=1.49, v_num=15]
























Epoch 47:  85%|█████████████████████████████████████████████████▎        | 1596/1875 [00:48<00:08, 33.07it/s, loss=1.48, v_num=15]
























Epoch 48:  83%|████████████████████████████████████████████████▏         | 1558/1875 [00:48<00:09, 32.38it/s, loss=1.49, v_num=15]
























Epoch 49:  93%|██████████████████████████████████████████████████████    | 1748/1875 [00:48<00:03, 36.02it/s, loss=1.49, v_num=15]























Epoch 50:  80%|██████████████████████████████████████████████▍           | 1501/1875 [00:46<00:11, 31.96it/s, loss=1.49, v_num=15]
























Epoch 51:  89%|███████████████████████████████████████████████████▋      | 1672/1875 [00:48<00:05, 34.67it/s, loss=1.49, v_num=15]

Testing: 0it [00:00, ?it/s]
Monitored metric val_loss did not improve in the last 15 records. Best score: 1.512. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Traceback (most recent call last):
  File "trainer.py", line 90, in <module>
    model = main(args)
  File "trainer.py", line 83, in main
    trainer.test(model)
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py", line 904, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py", line 682, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py", line 947, in _test_impl
    results = self._run(model, ckpt_path=self.tested_ckpt_path)
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py", line 1193, in _run
    self._dispatch()
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py", line 1268, in _dispatch
    self.training_type_plugin.start_evaluating(self)
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 206, in start_evaluating
    self._results = trainer.run_stage()
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py", line 1279, in run_stage
    return self._run_evaluate()
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py", line 1327, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/loops/base.py", line 145, in run
    self.advance(*args, **kwargs)
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 109, in advance
    dl_outputs = self.epoch_loop.run(dataloader, dataloader_idx, dl_max_batches, self.num_dataloaders)
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/loops/base.py", line 145, in run
    self.advance(*args, **kwargs)
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 123, in advance
    output = self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 211, in _evaluation_step
    output = self.trainer.accelerator.test_step(step_kwargs)
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/accelerators/accelerator.py", line 244, in test_step
    return self.training_type_plugin.test_step(*step_kwargs.values())
  File "/home/dev/miniconda3/envs/vec/lib/python3.6/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 222, in test_step
    return self.model.test_step(*args, **kwargs)
  File "/home/dev/classification/models/ResNet.py", line 107, in test_step
    metricObj = ClassificationMetrics(y_pred, y)
NameError: name 'ClassificationMetrics' is not defined